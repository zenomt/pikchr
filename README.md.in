Pikchr Command-Line Driver
==========================
[This preprocessor tool][repo] reads text from the standard input, [replacing][Unix]
suitably-delimited [Pikchr][] diagrams (a [PIC][]-like diagram language) with
inline Scalable Vector Graphics (SVG), and writes to the standard output.
It’s intended for use with your favorite Markdown processor, but can be used
standalone or with other markup languages too.

This tool uses the [C reference implementation of Pikchr by Richard Hipp][DRH]
which is included here for convenience (as permitted by its generous license).

``` pikchr
arrow right 225% "Markdown+Pikchr" "Source"
Tool: box rad 5px "pikchr" mono "Preprocessor" "(main.c)" mono fit
arrow same "Markdown+SVG" "Intermediate"
box same "Any Markdown" "Formatter" fit
arrow same "HTML+SVG" "Output"
arrow <-> down from Tool.s; "C API" ljust at 4pt right of last arrow
box with .n at last arrow.s same "Pikchr" "Formatter" "(pikchr.c)" mono fit
```

    ``` pikchr
    arrow right 225% "Markdown+Pikchr" "Source"
    Tool: box rad 5px "pikchr" mono "Preprocessor" "(main.c)" mono fit
    arrow same "Markdown+SVG" "Intermediate"
    box same "Any Markdown" "Formatter" fit
    arrow same "HTML+SVG" "Output"
    arrow <-> down from Tool.s; "C API" ljust at 4pt right of last arrow
    box with .n at last arrow.s same "Pikchr" "Formatter" "(pikchr.c)" mono fit
    ```

GitHub doesn’t allow inline SVGs, so here’s the above diagram as an external
image reference:

<img width="755px" src="usage.svg"/>

Example: Pipeline

    $ pikchr < file.md | Markdown.pl > file.html

Example: Intermediate file

    $ pikchr < README.md.in > README.md
    $ Markdown.pl < README.md > README.html

Example: Compile the first diagram in `README.md.in` to a separate SVG file
called `usage.svg`

    $ pikchr -qb -n 1 < README.md.in > usage.svg

Delimiters
----------
A Pikchr diagram starts with a line beginning with any of the following strings:

* <code>``` pikchr</code>
* `~~~ pikchr`
* `.PS`

and ends with the next line that is any of the following strings exactly (or
the end of the file):

* <code>```</code>
* `~~~`
* `.PE`

Anything not between a pair of start and end delimiters is copied to the
standard output unchanged.

Note that generic Markdown [fenced code blocks][fenced] can begin with three
_or more_ `~` (`TILDE`) or <code>&#96;</code> (`GRAVE ACCENT` backtick)
characters indented by up to three spaces, and continue to a matching fence.
For simplicity, this tool is less flexible when looking for Pikchr diagrams,
requiring exactly three unindented tildes or backticks (or the traditional
[PIC][] delimiters).

Building
--------

    $ git clone https://github.com/zenomt/pikchr-cmd
    $ cd pikchr-cmd
    $ make all
    $ ./pikchr -h


  [repo]: https://github.com/zenomt/pikchr-cmd
  [DRH]: https://github.com/drhsqlite/pikchr
  [Pikchr]: https://pikchr.org/
  [PIC]: https://en.wikipedia.org/wiki/PIC_(markup_language)
  [fenced]: https://spec.commonmark.org/0.30/#fenced-code-blocks
  [Unix]: https://en.wikipedia.org/wiki/Unix_philosophy
